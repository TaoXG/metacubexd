import{c as W,f as b,h as n,ah as ge,S as v,i as r,j as H,o as m,F as le,n as re,t as E,b as V,C as me,p as he,ai as X,aj as J,g as pe}from"./vendor-1082ac4c.js";import{B as A}from"./Button-6cdc8c17.js";import{P as $e,p as Y,m as B,n as q,o as f,L as ae,q as K,r as Z,i as xe,v as ee}from"./index-8416a89c.js";import{F as te}from"./ForTwoColumns-316699b4.js";import{u as F}from"./global-6c188e99.js";const ne=e=>{const[a,s]=W(100),c=b(()=>e.proxyNames.slice(0,a()));return n(ge,{get each(){return c()},get hasMore(){return c().length<e.proxyNames.length},next:()=>s(a()+30),children:i=>n($e,{proxyName:i,get isSelected(){return e.now===i},get onClick(){return e.onClick&&(()=>{var o;return(o=e.onClick)==null?void 0:o.call(e,i)})}})})},se=e=>{const a=()=>Y()===B.OFF,s=b(()=>e.proxyNameList.length<=30),c=b(()=>{const o=Y();return o===B.BAR||o===B.Auto&&!s()}),i=b(()=>{const o=Y();return o===B.DOTS||o===B.Auto&&s()});return n(v,{get when(){return!a()},get children(){return[n(v,{get when(){return c()},get children(){return n(ve,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}}),n(v,{get when(){return i()},get children(){return n(we,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}})]}})},be=m('<div class="flex h-6 w-full items-center gap-2"><div class="flex flex-1 overflow-hidden rounded-2xl"><div class="h-2 bg-success"></div><div class="h-2 bg-warning"></div><div class="h-2 bg-error"></div><div class="h-2 bg-neutral">'),ve=e=>{const{latencyMap:a}=q(),s=b(()=>e.proxyNameList.map(d=>a()[d])),c=b(()=>s().length),i=b(()=>s().filter(d=>d>f().NOT_CONNECTED&&d<=f().MEDIUM).length),o=b(()=>s().filter(d=>d>f().MEDIUM&&d<=f().HIGH).length),_=b(()=>s().filter(d=>d>f().HIGH).length),G=b(()=>s().filter(d=>d===f().NOT_CONNECTED).length);return(()=>{const d=be(),P=d.firstChild,S=P.firstChild,M=S.nextSibling,L=M.nextSibling,I=L.nextSibling;return r(d,n(ae,{get name(){return e.now}}),null),H(h=>{const k=`${i()*100/c()}%`,D=`${o()*100/c()}%`,T=`${_()*100/c()}%`,O=`${G()*100/c()}%`;return k!==h._v$&&((h._v$=k)!=null?S.style.setProperty("width",k):S.style.removeProperty("width")),D!==h._v$2&&((h._v$2=D)!=null?M.style.setProperty("width",D):M.style.removeProperty("width")),T!==h._v$3&&((h._v$3=T)!=null?L.style.setProperty("width",T):L.style.removeProperty("width")),O!==h._v$4&&((h._v$4=O)!=null?I.style.setProperty("width",O):I.style.removeProperty("width")),h},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),d})()},fe=m("<div>"),_e=m('<div class="flex items-center gap-2"><div class="flex flex-1 flex-wrap items-center">'),ye=e=>{let a=e.selected?"bg-white border-4 border-success":"bg-success";return typeof e.latency!="number"||e.latency===f().NOT_CONNECTED?a=e.selected?"bg-white border-4 border-neutral":"bg-neutral":e.latency>f().HIGH?a=e.selected?"bg-white border-4 border-error":"bg-error":e.latency>f().MEDIUM&&(a=e.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{const s=fe();return H(()=>re(s,E("m-1 h-4 w-4 rounded-full",a))),s})()},we=e=>{const{latencyMap:a}=q();return(()=>{const s=_e(),c=s.firstChild;return r(c,n(le,{get each(){return e.proxyNameList.map(i=>[i,a()[i]])},children:([i,o])=>{const _=e.now===i;return n(ye,{latency:o,selected:_})}})),r(s,n(ae,{get name(){return e.now}}),null),s})()},Ce=m('<progress class="progress" max="100">'),Ne=m('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),Pe=m('<div class="text-sm text-slate-500">Expire: <!> '),Se=e=>{const a=V(e.Total,{units:"iec"}),s=V(e.Download+e.Upload,{units:"iec"}),c=((e.Download+e.Upload)/e.Total*100).toFixed(2);return{total:a,used:s,percentage:c,expireStr:()=>e.Expire===0?"Null":me(e.Expire*1e3).format("YYYY-MM-DD")}},Me=e=>{if(!e.subscriptionInfo)return;const a=Se(e.subscriptionInfo);return[(()=>{const s=Ce();return H(()=>s.value=a.percentage),s})(),(()=>{const s=Ne(),c=s.firstChild,i=c.nextSibling,o=i.nextSibling,_=o.nextSibling;return _.nextSibling,r(s,()=>`${a.used}`,c),r(s,()=>`${a.total}`,i),r(s,()=>a.percentage,_),s})(),(()=>{const s=Pe(),c=s.firstChild,i=c.nextSibling;return i.nextSibling,r(s,()=>a.expireStr(),i),s})()]},ke=m('<div class="flex items-center gap-2"><div class="tabs tabs-boxed gap-2">'),Te=m('<div class="flex h-full flex-col gap-2"><div class="flex-1 overflow-y-auto">'),Ee=m('<button><span></span><div class="badge badge-sm">'),Le=m('<div class="mr-8 flex items-center justify-between"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div>'),De=m('<div class="text-sm text-slate-500"> :: <!> '),Oe=m('<div class="mr-8 flex items-center justify-between"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm">'),Be=m('<div class="text-sm text-slate-500"> ');var N=function(e){return e.proxyProviders="proxyProviders",e.proxies="proxies",e}(N||{});const Ge=()=>{const[e]=he(),{proxies:a,setProxyGroupByProxyName:s,latencyTestByProxyGroupName:c,latencyMap:i,proxyProviders:o,updateProviderByProviderName:_,updateAllProvider:G,healthCheckByProviderName:d}=q(),{map:P,set:S}=F(),{map:M,setWithCallback:L}=F(),I=async(g,u)=>{s(g,u)},h=async(g,u)=>{g.stopPropagation(),L(u,()=>c(u))},{map:k,setWithCallback:D}=F(),{map:T,setWithCallback:O}=F(),[z,Q]=W(!1),ie=(g,u)=>{g.stopPropagation(),D(u,()=>d(u))},ce=(g,u)=>{g.stopPropagation(),O(u,()=>_(u))},oe=async g=>{g.stopPropagation(),Q(!0);try{await G()}catch{}Q(!1)},[U,de]=W(N.proxies),ue=()=>[{type:N.proxies,name:e("proxies"),count:a().length},{type:N.proxyProviders,name:e("proxyProviders"),count:o().length}];return(()=>{const g=Te(),u=g.firstChild;return r(g,n(v,{get when(){return o().length>0},get children(){const t=ke(),w=t.firstChild;return r(w,n(le,{get each(){return ue()},children:x=>(()=>{const y=Ee(),l=y.firstChild,p=l.nextSibling;return y.$$click=()=>de(x.type),r(l,()=>x.name),r(p,()=>x.count),H(()=>re(y,E(U()===x.type&&"tab-active","tab gap-2 px-2"))),y})()})),r(t,n(v,{get when(){return U()===N.proxyProviders},get children(){return n(A,{class:"btn btn-circle btn-sm",get disabled(){return z()},onClick:x=>oe(x),get children(){return n(X,{get class(){return E(z()&&"animate-spin text-success")}})}})}}),null),t}}),u),r(u,n(v,{get when(){return U()===N.proxyProviders},get children(){return n(te,{get subChild(){return o().map(t=>{const w=K(t.proxies.map(l=>l.name)??[],i(),Z()),x=[(()=>{const l=Le(),p=l.firstChild,$=p.firstChild,R=$.nextSibling,C=p.nextSibling;return r($,()=>t.name),r(R,()=>t.proxies.length),r(C,n(A,{class:"btn btn-circle btn-sm mr-2",get disabled(){return T()[t.name]},onClick:j=>ce(j,t.name),get children(){return n(X,{get class(){return E(T()[t.name]&&"animate-spin text-success")}})}}),null),r(C,n(A,{class:"btn btn-circle btn-sm",get disabled(){return k()[t.name]},onClick:j=>ie(j,t.name),get children(){return n(J,{get class(){return E(k()[t.name]&&"animate-pulse text-success")}})}}),null),l})(),n(Me,{get subscriptionInfo(){return t.subscriptionInfo}}),(()=>{const l=De(),p=l.firstChild,$=p.nextSibling;return $.nextSibling,r(l,()=>t.vehicleType,p),r(l,()=>e("updated"),$),r(l,()=>xe(t.updatedAt),null),l})(),n(v,{get when(){return!P()[t.name]},get children(){return n(se,{proxyNameList:w})}})],y=n(ne,{proxyNames:w});return n(ee,{get isOpen(){return P()[t.name]},title:x,content:y,onCollapse:l=>S(t.name,l)})})}})}}),null),r(u,n(v,{get when(){return U()===N.proxies},get children(){return n(te,{get subChild(){return a().map(t=>{const w=K(t.all??[],i(),Z()),x=[(()=>{const l=Oe(),p=l.firstChild,$=p.firstChild,R=$.nextSibling;return r($,()=>t.name),r(R,()=>{var C;return(C=t.all)==null?void 0:C.length}),r(l,n(A,{class:"btn-circle btn-sm",get disabled(){return M()[t.name]},onClick:C=>h(C,t.name),get children(){return n(J,{get class(){return E(M()[t.name]&&"animate-pulse text-success")}})}}),null),l})(),(()=>{const l=Be(),p=l.firstChild;return r(l,()=>t.type,p),r(l,()=>{var $;return(($=t.now)==null?void 0:$.length)>0&&` :: ${t.now}`},null),l})(),n(v,{get when(){return!P()[t.name]},get children(){return n(se,{proxyNameList:w,get now(){return t.now}})}})],y=n(ne,{proxyNames:w,get now(){return t.now},onClick:l=>{I(t,l)}});return n(ee,{get isOpen(){return P()[t.name]},title:x,content:y,onCollapse:l=>S(t.name,l)})})}})}}),null),g})()};pe(["click"]);export{Ge as default};
